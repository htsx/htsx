const events={},toAppend={};HTMLElement.prototype.addEventListenerProxy=HTMLElement.prototype.addEventListener,HTMLElement.prototype.addEventListener=function(a,b){this.addEventListenerProxy(a,b),this.listeners||(this.listeners=[]),this.listeners.push({event:a,handler:b})};const createListener=(a,b,c)=>{const d=a.getAttribute(b);d&&(a.removeAttribute(b),a.addEventListener(c,a=>events[d].call(a.target,a)))},cloneNode=a=>{const b=a.cloneNode(!1);return a.listeners&&a.listeners.forEach(a=>{b.addEventListener(a.event,b=>a.handler.call(b.target,b))}),a.childNodes.length&&Array.from(a.childNodes).forEach(a=>b.appendChild(cloneNode(a))),b},appendNodes=a=>{const b=a.getAttribute("data-append");b&&(a.removeAttribute("data-append"),Array.isArray(toAppend[b])?toAppend[b].forEach(b=>{"string"==typeof b?a.append(b):a.appendChild(cloneNode(b))}):a.appendChild(toAppend[b]),delete toAppend[b])},attachEvents=a=>{const b="BODY"===a[0].parentElement.tagName?document.createElement("div"):a[0].parentElement;return Array.from(a).forEach(a=>{a.getAttribute&&(createListener(a,"onClick","click"),createListener(a,"onKeyPress","keypress"),createListener(a,"onKeyUp","keyup"),createListener(a,"onChange","onchange"),createListener(a,"onMouseOver","onmouseover"),createListener(a,"onMouseOut","onmouseout"),appendNodes(a)),a.childNodes.length&&attachEvents(a.childNodes),b.appendChild(a)}),b};var index=(a,...b)=>{const c=a.map((a,c)=>{const d=Date.now()+c;switch(typeof b[c]){case"function":return events[d]=b[c],`${a}${d}`;case"object":return toAppend[d]=b[c],`${a}<div data-append="${d}"></div>`;default:return`${a}${b[c]||""}`;}}).join(""),d=new DOMParser().parseFromString(c,"text/html").body.childNodes;return attachEvents(d)};export default index;
